<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- Use the title from a page's frontmatter if it has one -->
  <title>Sample4</title>
  <link href="stylesheets/bootstrap.css" rel="stylesheet" />
  <link href="stylesheets/site.css" rel="stylesheet" />
  <script src="javascripts/jquery-3.3.1.js"></script>
  <script src="javascripts/site.js"></script>
</head>
<body>
<div class="container-fluid">
  <div id="three-scene" class="w-100 h-100">
  <video id="video" style="display:none"></video>
</div>

<script src="javascripts/three.js"></script>

<script type="text/javascript">
  let camera, scene, renderer, video;

  init();
  animate();

  function init() {

    camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.01, 10);
    camera.position.z = 1;

    scene = new THREE.Scene();

    video = document.getElementById('video');
    const texture = new THREE.VideoTexture(video);
    texture.minFilter = THREE.LinearFilter;
    texture.magFilter = THREE.LinearFilter;
    texture.format = THREE.RGBFormat;

    const geometry = new THREE.PlaneBufferGeometry();
    const material = new THREE.MeshBasicMaterial({map: texture});

    const mesh = new THREE.Mesh(geometry, material);
    scene.add(mesh);

    renderer = new THREE.WebGLRenderer({antialias: true});
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    initWebcamInput();
  }

  function initWebcamInput() {
    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
      navigator.mediaDevices.getUserMedia({video: true}).then(stream = > {
        video.src = window.URL.createObjectURL(stream);
        video.play();
      });
    }
  }

  function animate() {
    requestAnimationFrame(animate);
    renderer.render(scene, camera);
  }

</script>

</div>

</body>
</html>
